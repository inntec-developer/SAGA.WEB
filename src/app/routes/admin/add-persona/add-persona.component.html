<div class="content-heading">
    <ul class="breadcrumb pull-right">
        <li>
            <a href="/home">Inicio</a>
        </li>
        <li class="active">Administrador</li>
    </ul>
    <small>Administrar Usuario</small>
</div>
<div *ngIf="bandera">
    <div class="row">
        <app-upload-imgs #uploadImg
            [maxFileSize]="1*1024*1024"
            [accept]="['image/png', 'image/jpeg', 'image/jpg', 'image/bmp']"
            [errorMessageMaxSize]="'File size great than 1MB'"
            [name]="name"
            (onItemChanged)="updateFoto()"
        ></app-upload-imgs>
    </div>  
</div>
<div class="row">
    <div class="panel panel-default panel-flat mat-elevation-z8">
        <div class="panel-body">
        <p class="text-center pv">USUARIOS</p>
            <div class="table-responsive">
               <table class="table table-bordered table-hover">
                 <thead>
                    <tr>
                        <th class="text-center"></th>
                        <th class="text-center">Clave</th>
                        <th class="text-center">Alias</th>
                        <th class="text-center">Nombre</th>
                        <th class="text-center">Apellido Paterno</th>
                        <th class="text-center">Apellido Materno</th>
                        <th class="text-center">Email</th>
                        <th class="text-center">Departamento</th>
                        <th class="text-center">Tipo Usuario</th>
                        <th class="text-center">Activar</th>
                        <th class="text-center"></th>
                    </tr>
                 </thead>
                 <tbody>
                    <tr *ngFor="let p of Users; let rowIndex = index">
                        <td class="text-center">
                          <div class="media">
                            <a matTooltip="Click to edit" (click)="bandera = true; rowAux = rowIndex; CrearURL(p.id)"><img class="img-responsive img-circle" src="{{p.foto}}" alt="Image" /></a>
                          </div>
                        </td>
                        <td class="text-center">
                          <span matTooltip="Double click to edit" (dblclick)="editing[rowIndex + '-clave'] = true" *ngIf="!editing[rowIndex + '-clave']">
                             {{p.clave}}
                          </span>
                          <input autofocus (blur)="updateValue($event, 'clave', rowIndex)" *ngIf="editing[rowIndex + '-clave']" type="text" [value]=p.clave />
                        </td>
                        <td class="text-center">
                           <span title="Double click to edit" (dblclick)="editing[rowIndex + '-usuario'] = true" *ngIf="!editing[rowIndex + '-usuario']">
                                {{p.usuario}}
                           </span>
                           <input autofocus (blur)="updateValue($event, 'usuario', rowIndex)" *ngIf="editing[rowIndex + '-usuario']" type="text" [value]=p.usuario />
                        </td>
                        <td class="text-center">
                            <span matTooltip="Double click to edit" (dblclick)="editing[rowIndex + '-nombre'] = true" *ngIf="!editing[rowIndex + '-nombre']">
                                {{p.nombre}}
                            </span>
                            <input autofocus (blur)="updateValue($event, 'nombre', rowIndex)" *ngIf="editing[rowIndex + '-nombre']" type="text" [value]=p.nombre />
                        </td>
                        <td class="text-center">
                            <span matTooltip="Double click to edit" (dblclick)="editing[rowIndex + '-apellidoPaterno'] = true" *ngIf="!editing[rowIndex + '-apellidoPaterno']">
                                {{p.apellidoPaterno}}
                            </span>
                            <input autofocus (blur)="updateValue($event, 'apellidoPaterno', rowIndex)" *ngIf="editing[rowIndex + '-apellidoPaterno']" type="text" [value]=p.apellidoPaterno />
                        </td>
                        <td class="text-center">
                            <span matTooltip="Double click to edit" (dblclick)="editing[rowIndex + '-apellidoMaterno'] = true" *ngIf="!editing[rowIndex + '-apellidoMaterno']">
                                {{p.apellidoMaterno}}
                            </span>
                            <input autofocus (blur)="updateValue($event, 'apellidoMaterno', rowIndex)" *ngIf="editing[rowIndex + '-apellidoMaterno']" type="text" [value]=p.apellidoMaterno />
                        </td>
                        <td>
                            <tr *ngFor="let e of p.email" class="text-center">{{e.email}}</tr>
                        </td>
                        <td class="text-center"> 
                            <span matTooltip="Double click to edit" (dblclick)="editing[rowIndex + '-departamento'] = true" *ngIf="!editing[rowIndex + '-departamento']">
                                {{p.departamento}}
                            </span>
                            <select (change)="updateValue($event, 'departamentoId', rowIndex)" *ngIf="editing[rowIndex + '-departamento']">
                                <option [value]=0>Seleccionar Departamento</option>
                                <option *ngFor="let d of ListDepas" [value]='d.id'>{{d.nombre}}</option>
                            </select>
                        </td>
                        <td class="text-center">
                            <span matTooltip="Double click to edit" (dblclick)="editing[rowIndex + '-tipoUsuario'] = true" *ngIf="!editing[rowIndex + '-tipoUsuario']">
                                {{p.tipoUsuario}}
                            </span>
                            <select (change)="updateValue($event, 'tipoUsuarioId', rowIndex)" *ngIf="editing[rowIndex + '-tipoUsuario']" >
                                <option [value]=0>Seleccionar Tipo Usuario</option>
                                <option *ngFor="let t of ListTipos" [value]='t.id'>{{t.tipo}}</option>
                            </select>
                        </td>
                        <td class="text-center">
                            <label class="switch">
                                <input type="checkbox" [checked]="p.activo" (change)="Actualizar($event, p.id)" />
                                <span></span>
                            </label>
                        </td>
                        <td class="text-center">
                            <btn-check id='update' chkPrivilegiosButtons (click)="updateUser($event, rowIndex)" matTooltip="Guardar Cambios"></btn-check>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>   

               <div class="panel-footer">
                   <div class="row">
                       <div class="col-lg-2">
                           <div class="input-group">

                           </div>
                       </div>
                       <div class="col-lg-8"></div>
                       <div class="col-lg-2">
                        
                       </div>
                   </div>
               </div>
               <p><span class="text-center pv">{{msj}}</span></p>
        
